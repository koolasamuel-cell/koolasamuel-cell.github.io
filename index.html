<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KWASIADA FRANKAA - Ashanti Edition</title>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8880362669865809"
     crossorigin="anonymous"></script>

<style>
:root {
    --ashanti-gold: #FFD700;
    --ashanti-green: #00AA00;
    --ashanti-black: #000000;
    --dark-bg: #0a0a0a;
    --panel-bg: #1a1a1a;
    --input-bg: #121212;
}

body {
    margin: 0;
    background-color: var(--dark-bg);
    color: white;
    font-family: 'Segoe UI', Roboto, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Header */
#header {
    width: 100%;
    padding: 20px 0;
    background: var(--ashanti-black);
    border-bottom: 4px solid var(--ashanti-gold);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 30px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.8);
}
.flag-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}
.flag-text { color: white; font-weight: bold; font-size: 12px; letter-spacing: 2px; text-transform: uppercase; }
.ashanti-flag {
    width: 85px; height: 52px; border: 2px solid #333;
    display: flex; flex-direction: column; border-radius: 4px; overflow: hidden; position: relative;
}
.stripe { flex: 1; width: 100%; position: relative; }
.golden-stool {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 24px; height: 16px; background: var(--ashanti-gold);
    clip-path: polygon(10% 0%, 90% 0%, 100% 20%, 80% 20%, 80% 70%, 100% 70%, 100% 100%, 0% 100%, 0% 70%, 20% 70%, 20% 20%, 0% 20%);
}
#title { font-size: clamp(24px, 5vw, 38px); color: var(--ashanti-gold); text-shadow: 2px 2px 0 #000; margin: 0; letter-spacing: 3px; }

/* 3D Interface */
.container { width: 95%; max-width: 600px; margin-top: 25px; padding-bottom: 50px; perspective: 1000px; }
#gameCanvas {
    background: #111; border: 10px solid #222; border-radius: 10px;
    width: 100%; aspect-ratio: 1/1; max-width: 600px;
    margin: 20px 0;
    transform: rotateX(15deg); box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    transition: transform 0.5s ease;
    cursor: pointer;
}
#gameCanvas:hover { transform: rotateX(5deg); }
.panel-3d {
    background: var(--panel-bg); padding: 25px; border-radius: 20px;
    border: 2px solid #333; box-shadow: 0 15px 35px rgba(0,0,0,0.5); text-align: center;
}
.section-title { color: var(--ashanti-gold); font-size: 1.2rem; margin: 25px 0 15px; text-transform: uppercase; letter-spacing: 1px; }

/* Buttons & Inputs */
.mode-toggle { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
.mode-btn {
    flex: 1; padding: 12px; border-radius: 10px; border: none; background: #333; color: #888;
    cursor: pointer; font-weight: bold; transition: 0.3s;
}
.mode-btn.active { background: var(--ashanti-gold); color: black; }

input, select {
    width: 90%; padding: 12px; margin: 8px 0; background: var(--input-bg);
    border: 1px solid #333; border-radius: 8px; color: white; font-size: 16px;
}
.diff-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
.diff-card { background: #222; padding: 15px 5px; border-radius: 12px; cursor: pointer; border: 2px solid transparent; font-size: 0.8rem;}
.diff-card.active { border-color: var(--ashanti-gold); background: #2a2a2a; }
.start-btn {
    width: 100%; padding: 18px; background: var(--ashanti-green); color: white;
    border: none; border-radius: 12px; font-size: 20px; font-weight: bold; cursor: pointer;
    margin-top: 20px; box-shadow: 0 4px 0 #006400;
}

/* Game Over Buttons */
.game-over-buttons {
    display: none;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}
.game-over-btn {
    padding: 15px 30px;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}
.replay-btn { background: var(--ashanti-green); color: white; }
.menu-btn { background: var(--ashanti-gold); color: black; }
.next-btn { background: #FF6B35; color: white; }

/* Celebration */
#celebration-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 100; display: none;
}
.balloon {
    position: absolute; bottom: -100px; font-size: 40px;
    animation: floatUp 4s linear forwards;
}
@keyframes floatUp { to { transform: translateY(-120vh); opacity: 0; } }
.hidden { display: none !important; }
#status { font-size: 24px; color: var(--ashanti-gold); margin-bottom: 10px; font-weight: bold;}
footer { margin-top: auto; padding: 30px; font-size: 12px; color: #555; text-align: center; }
</style>
</head>
<body onclick="initAudio();">

<div id="celebration-overlay"></div>

<div id="header">
    <div class="flag-box">
        <span class="flag-text">Ashanti</span>
        <div class="ashanti-flag">
            <div class="stripe" style="background:var(--ashanti-gold)"></div>
            <div class="stripe" style="background:var(--ashanti-black)">
                <div class="golden-stool"></div>
            </div>
            <div class="stripe" style="background:var(--ashanti-green)"></div>
        </div>
    </div>
    <h1 id="title">KWASIADA FRANKAA</h1>
</div>

<div class="container" id="menu-ui">
    <div class="panel-3d">
        <div class="mode-toggle">
            <button class="mode-btn active" id="btnComp" onclick="setMode('vsComp')">vs Computer</button>
            <button class="mode-btn" id="btnHuman" onclick="setMode('vsHuman')">vs Human</button>
        </div>

        <input id="p1Name" onchange="updateStarterOptions()" placeholder="Player Name" value="Koola">
        <input id="p2Name" onchange="updateStarterOptions()" class="hidden" placeholder="Player 2 Name" value="Nana">

        <div class="section-title">Difficulty Level</div>
        <div class="diff-grid">
            <div class="diff-card active" id="d1" onclick="setDiff(1,'d1')">‚≠ê Okukudurufo</div>
            <div class="diff-card" id="d6" onclick="setDiff(6,'d6')">üõ°Ô∏è Okofo</div>
            <div class="diff-card" id="d20" onclick="setDiff(20,'d20')">‚öîÔ∏è Osagyefo</div>
        </div>

        <select id="starterSelect">
            <option value="player1">Koola Starts</option>
            <option value="player2">Opponent Starts</option>
        </select>

        <button class="start-btn" onclick="startGame()">START MATCH</button>
    </div>

    <div class="history-panel" style="text-align: center; margin-top: 20px;">
        <h3 style="background-color: var(--ashanti-gold); color: black; display: inline-block; padding: 8px 16px; border-radius: 6px; text-transform: uppercase; letter-spacing: 2px; font-weight: bold; margin-bottom: 6px;">
            ABOUT KWASIADA FRANKAA
        </h3>
        <div style="background-color: var(--ashanti-black); color: white; padding: 12px 15px; border-radius: 8px; font-family: Arial, sans-serif; line-height: 1.5; text-align: left; border: 1px solid #333;">
            <p><strong>Kwasiada Frankaa</strong> is a traditional Ashanti strategy board game. "<strong>Kwasiada</strong>" refers to Sunday, while "<strong>Frankaa</strong>" means flag‚Äîa symbol of leadership or victory.</p>
            <div id="moreText" style="display: none;">
                <p><strong>Origin:</strong> Originated in Ashanti communities around the 1880s. Children used charcoal to draw lines and stones to represent the three pawns.</p>
                <p><strong>Objective:</strong> Align all 3 pawns in a straight line‚Äîvertically, horizontally, or diagonally. Moves are restricted to adjacent connected points.</p>
            </div>
            <button id="readMoreBtn" onclick="toggleReadMore()" style="margin-top: 10px; background-color: var(--ashanti-gold); color: black; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-weight: bold;">
                Read More
            </button>
        </div>
    </div>
</div>

<div class="container hidden" id="game-ui" style="text-align:center;">
    <div id="status">Koola's Turn</div>
    <canvas id="gameCanvas" width="600" height="600"></canvas>
    <div style="display:flex;gap:10px;justify-content:center;">
        <button class="mode-btn" style="background:white;color:black;" onclick="undoMove()">UNDO</button>
        <button class="mode-btn" style="background:#a00;color:white;" onclick="location.reload()">QUIT</button>
    </div>
    
    <div class="game-over-buttons" id="gameOverButtons">
        <button class="game-over-btn replay-btn" onclick="replayGame()">REPLAY</button>
        <button class="game-over-btn menu-btn" onclick="goToMainMenu()">MAIN MENU</button>
        <button class="game-over-btn next-btn hidden" id="nextLevelBtn" onclick="nextLevel()">NEXT LEVEL</button>
    </div>
</div>

<footer>
&copy; 2026 Koola &bull; Kwasiada Frankaa<br>
Preserving Ashanti Cultural Heritage Through Digital Gaming.
</footer>

<script>
/* --- AUDIO & UTILS --- */
let audioInitialized=false, audioCtx, chimeSound;
function initAudio(){
    if(audioInitialized) return;
    audioInitialized=true; 
    audioCtx=new (window.AudioContext||window.webkitAudioContext)();
    chimeSound=new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
}

function playClick(f,d){
    if(!audioCtx) return;
    let o=audioCtx.createOscillator(), g=audioCtx.createGain();
    o.type="sine"; o.frequency.setValueAtTime(f,audioCtx.currentTime);
    g.gain.setValueAtTime(0.3,audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+d);
    o.connect(g); g.connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime+d);
}

function speakResultWithChime(message){
    try {
        if(chimeSound) chimeSound.play().catch(e=>console.log(e));
        if('speechSynthesis' in window){
            const utterance = new SpeechSynthesisUtterance(message);
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }
    } catch(e) { console.log(e); }
}

function toggleReadMore() {
    const moreText = document.getElementById("moreText");
    const btn = document.getElementById("readMoreBtn");
    const isHidden = moreText.style.display === "none";
    moreText.style.display = isHidden ? "block" : "none";
    btn.innerText = isHidden ? "Read Less" : "Read More";
}

/* --- GAME LOGIC --- */
const canvas=document.getElementById("gameCanvas"), ctx=canvas.getContext("2d");
const points=[{x:100,y:100},{x:300,y:100},{x:500,y:100},{x:100,y:300},{x:300,y:300},{x:500,y:300},{x:100,y:500},{x:300,y:500},{x:500,y:500}];
const links=[[0,1],[1,2],[3,4],[4,5],[6,7],[7,8],[0,3],[3,6],[1,4],[4,7],[2,5],[5,8],[0,4],[2,4],[6,4],[8,4]];
const winLines=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

let playerPawns=[], computerPawns=[], stateStack=[], gameMode="vsComp", currentTurn="player1", gameState="menu", diffLevel=1;
let selectedPawn=-1;

function setMode(m){
    playClick(500,0.1); gameMode=m;
    document.getElementById("btnComp").classList.toggle("active",m==='vsComp');
    document.getElementById("btnHuman").classList.toggle("active",m==='vsHuman');
    document.getElementById("p2Name").classList.toggle("hidden",m==='vsComp'); 
    updateStarterOptions();
}

function updateStarterOptions(){
    const p1=document.getElementById("p1Name").value || "Koola";
    const p2=gameMode==="vsComp"?"Opponent": (document.getElementById("p2Name").value || "Nana");
    document.getElementById("starterSelect").innerHTML=`<option value="player1">${p1} Starts</option><option value="player2">${p2} Starts</option>`;
}

function setDiff(val,id){
    playClick(600,0.1); diffLevel=val; 
    document.querySelectorAll('.diff-card').forEach(c=>c.classList.remove('active')); 
    document.getElementById(id).classList.add('active');
}

function startGame(){
    playClick(800,0.2);
    gameState="placing"; playerPawns=[]; computerPawns=[]; stateStack=[]; selectedPawn=-1;
    currentTurn=document.getElementById("starterSelect").value;
    document.getElementById("menu-ui").classList.add("hidden");
    document.getElementById("game-ui").classList.remove("hidden");
    document.getElementById("gameOverButtons").style.display = "none";
    updateStatus();
    draw();
    if(gameMode==="vsComp" && currentTurn==="player2") setTimeout(aiTurn,800);
}

canvas.onclick=(e)=>{
    if(gameState==="ended") return;
    const rect=canvas.getBoundingClientRect();
    const x=(e.clientX-rect.left)*(600/rect.width);
    const y=(e.clientY-rect.top)*(600/rect.height);
    
    points.forEach((p,i)=>{
        if(Math.hypot(x-p.x,y-p.y)<40){
            handlePointClick(i);
        }
    });
};

function handlePointClick(i) {
    const currentP = currentTurn === "player1" ? playerPawns : computerPawns;
    
    if(gameState === "placing") {
        if(!playerPawns.includes(i) && !computerPawns.includes(i) && currentP.length < 3) {
            stateStack.push([playerPawns.slice(), computerPawns.slice()]);
            currentP.push(i);
            playClick(300, 0.1);
            if(playerPawns.length === 3 && computerPawns.length === 3) gameState = "moving";
            endTurn();
        }
    } else if(gameState === "moving") {
        if(selectedPawn === -1) {
            if(currentP.includes(i)) {
                selectedPawn = i;
                playClick(400, 0.1);
                draw();
            }
        } else {
            if(i === selectedPawn) {
                selectedPawn = -1;
                draw();
            } else if(!playerPawns.includes(i) && !computerPawns.includes(i) && isValidMove(selectedPawn, i)) {
                stateStack.push([playerPawns.slice(), computerPawns.slice()]);
                const idx = currentP.indexOf(selectedPawn);
                currentP[idx] = i;
                selectedPawn = -1;
                playClick(300, 0.15);
                endTurn();
            } else if(currentP.includes(i)) {
                selectedPawn = i;
                draw();
            }
        }
    }
}

function isValidMove(from, to) {
    return links.some(l => (l[0]===from && l[1]===to) || (l[1]===from && l[0]===to));
}

function draw(){
    ctx.clearRect(0,0,600,600);
    // Draw Board Lines
    ctx.strokeStyle="#555"; ctx.lineWidth=8;
    links.forEach(l=>{
        ctx.beginPath(); ctx.moveTo(points[l[0]].x,points[l[0]].y); 
        ctx.lineTo(points[l[1]].x,points[l[1]].y); ctx.stroke();
    });
    // Draw Points
    points.forEach(p=>{
        ctx.fillStyle="#333"; ctx.beginPath(); ctx.arc(p.x,p.y,12,0,7); ctx.fill();
    });
    // Draw Pawns
    playerPawns.forEach(p => drawPawn(p, "#FFD700", "#B8860B", p === selectedPawn));
    computerPawns.forEach(p => drawPawn(p, "#00AA00", "#006400", p === selectedPawn && gameMode === "vsHuman"));
}

function drawPawn(pos, c1, c2, isSelected){
    const p=points[pos];
    ctx.shadowBlur=isSelected ? 20 : 10;
    ctx.shadowColor=isSelected ? "white" : "black";
    let g=ctx.createRadialGradient(p.x-5,p.y-5,5,p.x,p.y,25);
    g.addColorStop(0,c1); g.addColorStop(1,c2);
    ctx.fillStyle=g; ctx.beginPath(); ctx.arc(p.x,p.y,28,0,7); ctx.fill();
    ctx.strokeStyle=isSelected ? "white" : "rgba(255,255,255,0.3)";
    ctx.lineWidth=isSelected ? 4 : 2; ctx.stroke();
    ctx.shadowBlur=0;
}

function endTurn(){
    draw();
    if(checkWin(playerPawns)) return gameOver(document.getElementById("p1Name").value, true);
    if(checkWin(computerPawns)) return gameOver(gameMode==="vsComp"?"AI":document.getElementById("p2Name").value, false);
    
    currentTurn = (currentTurn==="player1") ? "player2" : "player1";
    updateStatus();
    if(gameMode==="vsComp" && currentTurn==="player2") setTimeout(aiTurn, 600);
}

function checkWin(p){ return winLines.some(line=>line.every(pos=>p.includes(pos))); }

function updateStatus(){
    const p1 = document.getElementById("p1Name").value || "Koola";
    const p2 = gameMode==="vsComp" ? "AI" : (document.getElementById("p2Name").value || "Nana");
    const name = currentTurn==="player1" ? p1 : p2;
    const phase = gameState === "placing" ? "Placing" : "Moving";
    document.getElementById("status").innerText = `${name}'s Turn (${phase})`;
}

/* --- AI LOGIC --- */
function aiTurn(){
    if(gameState === "placing") {
        const free = points.map((_,i)=>i).filter(i=>!playerPawns.includes(i)&&!computerPawns.includes(i));
        if(free.length > 0) {
            let move = findBestPlacement(computerPawns, playerPawns);
            computerPawns.push(move);
            if(playerPawns.length === 3 && computerPawns.length === 3) gameState = "moving";
            endTurn();
        }
    } else {
        const move = findBestMove(computerPawns, playerPawns);
        if(move) {
            const idx = computerPawns.indexOf(move.from);
            computerPawns[idx] = move.to;
            endTurn();
        }
    }
}

function findBestPlacement(my, opp) {
    const free = points.map((_,i)=>i).filter(i=>!my.includes(i)&&!opp.includes(i));
    for(let p of free) if(checkWin([...my, p])) return p;
    for(let p of free) if(checkWin([...opp, p])) return p;
    return free.includes(4) ? 4 : free[Math.floor(Math.random()*free.length)];
}

function findBestMove(my, opp) {
    let moves = [];
    my.forEach(p => {
        points.forEach((_, i) => {
            if(!my.includes(i) && !opp.includes(i) && isValidMove(p, i)) {
                let test = [...my]; test[my.indexOf(p)] = i;
                if(checkWin(test)) return moves = [{from:p, to:i, win:true}];
                moves.push({from:p, to:i});
            }
        });
    });
    if(moves.find(m => m.win)) return moves.find(m => m.win);
    return moves[Math.floor(Math.random()*moves.length)];
}

function gameOver(name, isWin){
    gameState="ended";
    const overlay=document.getElementById("celebration-overlay");
    overlay.style.display="block";
    
    let msg = isWin ? `Congratulations ${name}, you won Pee-ow!` : `Sorry ${name}, AI wins. Try again!`;
    document.getElementById("status").innerText = isWin ? "VICTORY!" : "GAME OVER";
    document.getElementById("gameOverButtons").style.display = "flex";
    if(isWin) {
        triggerCelebration();
        document.getElementById("nextLevelBtn").classList.remove("hidden");
    }
    speakResultWithChime(msg);
}

function triggerCelebration(){
    const items=['üéà','üéä','üéâ','üèÜ','‚≠ê'];
    for(let i=0; i<30; i++){
        setTimeout(()=>{
            const b=document.createElement('div'); b.className='balloon';
            b.innerText=items[Math.floor(Math.random()*items.length)];
            b.style.left=Math.random()*90+'vw';
            document.getElementById("celebration-overlay").appendChild(b);
            setTimeout(()=>b.remove(), 4000);
        }, i*150);
    }
}

function undoMove(){ if(stateStack.length>0){ [playerPawns, computerPawns]=stateStack.pop(); gameState = (playerPawns.length < 3) ? "placing" : "moving"; draw(); updateStatus(); }}
function replayGame(){ startGame(); }
function goToMainMenu(){ location.reload(); }
function nextLevel(){ if(diffLevel===1) setDiff(6,'d6'); else if(diffLevel===6) setDiff(20,'d20'); startGame(); }
</script>
</body>
</html>
